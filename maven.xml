<project 
  default="build"
  xmlns:j="jelly:core"
  xmlns:maven="jelly:maven"
  xmlns:deploy="deploy"
  xmlns:velocity="jelly:org.apache.commons.jelly.tags.velocity.VelocityTagLibrary">

  <!--
   |
   | Build all the Fulcrum components.
   |
   -->

  <goal name="build">
    
    <maven:reactor
      basedir="${basedir}"
      includes="*/project.xml"
      excludes="axis/*,summit/*,xmlrpc/*"
      goals="clean,jar:jar,jar:install"
      banner="Building"
      ignoreFailures="false"
    />

  </goal>


  <!--
   |
   | Build docs for all the Fulcrum components.
   |
   -->

  <goal name="site-all">
    
    <maven:reactor
      basedir="${basedir}"
      includes="*/project.xml"
      excludes="jcs/*"
      goals="clean,site"
      banner="Building Site :"
      ignoreFailures="false"
    />
   </goal>
  <!--
   |
   | Deploy docs for all the Fulcrum components.
   |
   -->

  <goal name="site-deploy-all">
    
    <maven:reactor
      basedir="${basedir}"
      includes="*/project.xml"
      excludes="jcs/*"
      goals="site:deploy"
      banner="Building"
      ignoreFailures="false"
    />
   </goal>

  <!--
   |
   | Deploy all the Fulcrum components and their POMs 
   | to the central repository.
   |
   -->

  <goal name="deploy-poms">
    
    <maven:reactor
      basedir="${basedir}"
      includes="*/project.xml"
      excludes="jcs/*"
      goals="pom:deploy"
      banner="Building"
      ignoreFailures="false"
    />
  </goal>

  <goal name="install-poms">
    
    <maven:reactor
      basedir="${basedir}"
      includes="*/project.xml"
      excludes="jcs/*"
      goals="pom:install"
      banner="Building"
      ignoreFailures="false"
    />
  </goal>

  <goal name="deploy-components">
    
    <maven:reactor
      basedir="${basedir}"
      includes="*/project.xml"
      excludes="jcs/*"
      goals="jar:deploy"
      banner="Building"
      ignoreFailures="false"
    />
  </goal>

  <!--
   |
   | Create the list of components available for the 
   | Plexus plugin to use when aiding users in creating runtimes.
   |
   -->
  
  <goal name="component-manifest">
    
    <maven:reactor
      basedir="${basedir}"
      includes="*/project.xml"
      excludes="jcs/*"
      banner="Building"
      ignoreFailures="false"
      postProcessing="true"
    />

    <velocity:merge 
      name="${plexus.component.manifest}"
      basedir="${basedir}"
      template="component-manifest.vm"
    />

  </goal>

  <goal name="deploy-component-manifest" prereqs="component-manifest">

    <deploy:artifact
      artifact="${plexus.component.manifest}"
      assureDirectoryCommand="mkdir -p"
    />
    
  </goal>
  
  
</project>
